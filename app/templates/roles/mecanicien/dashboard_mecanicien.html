{% extends "roles/mecanicien/_base_mecanicien.html" %}
{% block title %}Tableau de Bord Mécanicien{% endblock %}

{% set active_page = 'dashboard' %}
{% set page_title = 'Tableau de Bord Mécanicien' %}

{% block dashboard_content %}
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ stats.bus_total }}</div>
                        <div class="stat-label">Bus AED Total</div>
                    </div>
                    <div class="stat-icon blue">
                        <i class="fas fa-bus"></i>
                    </div>
                </div>
                <div class="stat-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>Flotte UdM</span>
                </div>
            </div>

            <div class="stat-card success">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ stats.bus_bon_etat }}</div>
                        <div class="stat-label">Bus en Bon État</div>
                    </div>
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                </div>
                <div class="stat-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>Opérationnels</span>
                </div>
            </div>

            <div class="stat-card danger">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ stats.bus_en_panne }}</div>
                        <div class="stat-label">Bus en Panne</div>
                    </div>
                    <div class="stat-icon red">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                </div>
                <div class="stat-change negative">
                    <i class="fas fa-arrow-down"></i>
                    <span>Hors service</span>
                </div>
            </div>

            <div class="stat-card warning">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ stats.bus_vidange_urgente }}</div>
                        <div class="stat-label">Vidanges Urgentes</div>
                    </div>
                    <div class="stat-icon orange">
                        <i class="fas fa-oil-can"></i>
                    </div>
                </div>
                <div class="stat-change negative">
                    <i class="fas fa-arrow-down"></i>
                    <span>À traiter</span>
                </div>
            </div>
        </div>

        <!-- Actions Rapides -->
        <div class="quick-actions">
            <h2 class="section-title">
                <i class="fas fa-bolt"></i>
                Actions Rapides
            </h2>
            <div class="actions-grid">
                <a href="{{ url_for('mecanicien.vidange') }}" class="action-btn">
                    <i class="fas fa-oil-can"></i>
                    <span>Vidange</span>
                </a>
                <a href="{{ url_for('mecanicien.carburation') }}" class="action-btn">
                    <i class="fas fa-gas-pump"></i>
                    <span>Carburation</span>
                </a>
                <a href="#" id="declare-panne-btn" class="action-btn">
                    <i class="fas fa-triangle-exclamation"></i>
                    <span>Déclaration de panne</span>
                </a>
                <a href="{{ url_for('mecanicien.depannage') }}" class="action-btn">
                    <i class="fas fa-tools"></i>
                    <span>Dépannage</span>
                </a>
            </div>
        </div>

        {% include 'shared/modals/_declaration_panne_modal.html' %}

{% endblock %}

{% block extra_scripts %}
<script>
$(function() {
  // Bouton Déclaration de panne
  $('#declare-panne-btn').on('click', function(e) {
    e.preventDefault();
    $('#panneModal').addClass('show');
  });
});
</script>
{% endblock %}