@startuml Activite_Generale_Transport_UDM
' =============================================
' Diagramme d’activité (général) – Transport UdM
' =============================================
skinparam defaultFontName Arial
skinparam shadowing false
skinparam dpi 150
skinparam wrapWidth 2000

' Swimlanes par rôle principal
|Utilisateur|
start
:Ouvrir application;
:Se connecter;
if (Authentifié ?) then (Oui)
  :Accéder au tableau de bord;
else (Non)
  :Afficher erreur;
  stop
endif

fork
  :Consulter données (rapports/tableaux);
fork again
  :Effectuer actions selon rôle;
end fork

' =====================
' Branche Actions par rôle
' =====================
split
  |Administrateur|
  if (Administration ?) then (Oui)
    :Gérer utilisateurs;
    :Gérer parc véhicules;
    :Gérer documents véhicules;
    :Consulter/éditer rapports;
  else (Non)
    :Aucune action admin;
  endif
split again
  |Responsable|
  if (Pilotage ?) then (Oui)
    :Consulter tableaux de bord;
    :Générer rapports;
    :Planifier affectations chauffeurs;
  else (Non)
    :Aucune action responsable;
  endif
split again
  |Superviseur|
  if (Supervision ?) then (Oui)
    :Consulter tableaux de bord;
    :Analyser indicateurs;
  else (Non)
    :Aucune action superviseur;
  endif
split again
  |Charge Transport|
  if (Trajets ?) then (Oui)
    :Planifier trajet;
    :Affecter chauffeur/bus;
    :Associer prestataire si besoin;
    :Enregistrer départ/arrivée;
    :Saisir présence campus;
  else (Non)
    :Aucune action charge;
  endif
split again
  |Chauffeur|
  if (Course ?) then (Oui)
    :Consulter affectations;
    :Signaler panne si nécessaire;
    :Confirmer départ/arrivée;
  else (Non)
    :Aucune action chauffeur;
  endif
split again
  |Mécanicien|
  if (Maintenance ?) then (Oui)
    :Enregistrer carburation;
    :Enregistrer vidange;
    :Traiter dépannage;
  else (Non)
    :Aucune action mécanicien;
  endif
end split

' =====================
' Séquences clés encapsulées (appels)
' =====================
|Charge Transport|
:Planifier trajet;
partition "Planification Trajet" {
  :Saisir détails trajet;
  if (Chauffeur disponible ?) then (Oui)
    :Réserver chauffeur;
  else (Non)
    :Choisir autre chauffeur;
  endif
  if (Bus disponible ?) then (Oui)
    :Réserver bus;
  else (Non)
    :Choisir autre bus;
  endif
  :Créer enregistrement trajet;
}

|Mécanicien|
:Traiter panne/dépannage;
partition "Gestion Panne/Dépannage" {
  :Enregistrer panne;
  if (Criticité élevée ?) then (Oui)
    :Notifier équipe;
  endif
  :Planifier ou enregistrer dépannage;
  :Clôturer panne si résolue;
}

|Mécanicien|
:Enregistrer entretien;
partition "Carburation/Vidange" {
  :Saisir carburation (litres, prix, km);
  :Calculer coût total;
  :Enregistrer;
  :Saisir vidange (type huile, km, date);
  :Valider type d’huile;
  :Enregistrer;
}

|Administrateur|
:Gestion administrative;
partition "Utilisateurs & Documents" {
  :Créer/Modifier/Désactiver utilisateur;
  :Créer/Modifier/Supprimer véhicule;
  :Ajouter document du véhicule;
}

|Responsable|
:Générer rapports;
partition "Reporting" {
  :Sélectionner période/critères;
  :Agrégations & calculs indicateurs;
  :Exporter PDF/CSV;
}

' =====================
' Processus planifié (Carburant)
' =====================
| |  ' voie neutre (pas de rôle humain)
partition "Vérification Carburant (scheduler)" {
  :Analyser niveaux carburant;
  if (Seuil franchi ?) then (Oui)
    :Mettre à jour FuelAlertState;
    :Notifier administrateur;
  else (Non)
    :Aucune alerte;
  endif
}

|Utilisateur|
stop
@enduml
